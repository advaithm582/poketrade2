{% extends "base.html" %}
{% block title %}{{ the_pokemon.name }} - Stats{% endblock %}

{% block content %}
<style>

.card {
    background-color: #f44336;
    border-radius: 20px;
    padding: 20px;
    color: white;
    font-family: "Kumbh Sans";
    font-size: 20px;
    max-width: 800px;
    margin: auto;
}

.card .info-section {
    border-radius: 12px;
    padding: 20px;
    color: #fff;
    display: flex;
    flex-direction: row;
    gap: 20px;
    flex-wrap: wrap;
    align-items: flex-start;
}

.card .info-text {
    flex: 1;
    min-width: 250px;
}

.card .image-right {
    flex-shrink: 0;
    align-self: flex-start;
}

.card .image-right img {
    width: 200px;
    border-radius: 8px;
}

.types {
    display: flex;
}

.types span {
    background-color: black;
    color: white;
    padding: 3px 8px;
    border-radius: 5px;
    margin-right: 5px;
}
.subtypes {
    display: flex;
}

.subtypes li {
    display: inline;
    margin-right: 8px;
    background: black;
    padding: 3px 6px;
    border-radius: 5px;
}
.price {
    display: flex;
    min-width: 40%;
}

.nametag {
    margin-left: 5px;
}

.info-label {
    font-weight: bold;
    margin-top: 10px;
    display: inline-block;
}

.buy-button {
    background-color: #00e676;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    color: black;
    font-weight: bold;
    margin-top: 20px;
    cursor: pointer;
}

.sell-button {
    background-color: darkred;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    color: #FFCC03;
    font-weight: bold;
    margin-top: 20px;
    cursor: pointer;
}

.buttons-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    margin-top: 20px;
    gap: 10px;
}

@media (max-width: 800px) {
  .card .info-section {
    flex-direction: row;
    align-items: flex-start;
    justify-content: space-between;
    flex-wrap: wrap-reverse;
  }

  .card .info-text {
    flex: 1 1 60%;
    min-width: 0; 
  }

  .card .image-right {
    flex: 0 0 auto;
    align-self: flex-start;
  }

  .card .image-right img {
    max-width: 80%;
    height: auto;
  }

  .card .buttons-container {
    width: 100%;
    text-align: center;
    margin-top: 20px;
  }

  .card .buy-button,
  .card .buttons-container button {
    margin: 10px auto;
    display: inline-block;
  }
}
</style>

<div class="card">
<h2>{{ the_pokemon.name }}</h2>
    <div class="info-section">
        <div class="info-text">
            {% if the_pokemon.supertype %}
                <div class="info-label">Supertype:</div> {{ the_pokemon.supertype }}<br>
            {% endif %}

            {% if the_pokemon.subtypes %}
                <div class="info-label">Subtypes:</div>
                <ul class="subtypes">
                    {% for st in the_pokemon.subtypes %}
                    <li>{{ st }}</li>
                    {% endfor %}
                </ul>
            {% endif %}

            {% if the_pokemon.types %}
                <div class="info-label">Types:</div>
                <ul class="types">
                    {% for type in the_pokemon.types %}
                        <span>{{ type }}</span>
                    {% endfor %}
                </ul>
            {% endif %}

            {% if the_pokemon.hp >= 0 %}
                <div class="info-label">HP:</div> {{ the_pokemon.hp }}<br>
            {% endif %}

            {% if the_pokemon.flavorText %}
                <div class="info-label">Description:</div>
                <p>{{ the_pokemon.flavorText }}</p>
            {% endif %}


            {% if the_pokemon.evolves_from %}
                <div class="info-label">Evolves from:</div>
                {{ the_pokemon.evolves_from }}
            {% endif %}
            {% if the_pokemon.sell_price %}
                <div class="price">Current Price: {{ the_pokemon.sell_price }} </div>
            {% endif %}

            {% if the_pokemon.owner.username %}
                <div class="price">
                    Current Owner:
                    <a class="nametag" href="{% url 'profile' the_pokemon.owner.pk %}"> {{ the_pokemon.owner.username }}</a>
                </div>

            {% endif %}
        </div>
            <br><br>

        <div class="image-right">
            <img src="{{ the_pokemon.card.url }}" alt="{{ the_pokemon.name }}">
        </div>
    </div>
    <div class="row justify-content-center">
        <div class = "buttons-container">
            {% if the_pokemon.owner == user %}
                <form method="post">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <div class="row justify-content-center">
                        <button class="sell-button" type="submit">Update Price</button>
                    </div>
                </form>
            {% else %}
                {% if the_pokemon.sell_price %}
                    <form method="post" action="{% url "trading:buy_single" the_pokemon.pk %}">
                        {% csrf_token %}
                        <div class="row justify-content-center">
                            <button class="buy-button" type="submit">Buy</button>
                        </div>
                    </form>
                {% endif %}
                {% if in_wishlist %}
                    <form method="post" action="{% url "trading:unwish" the_pokemon.pk %}">
                        {% csrf_token %}
                        <button class="sell-button" type="submit">Remove from Wishlist</button>
                    </form>
                {% else %}
                    <form method="post" action="{% url "trading:wish" the_pokemon.pk %}">
                        {% csrf_token %}
                        <button class="buy-button" type="submit">Add to wishlist</button>
                    </form>
                {% endif %}
            {% endif %}
        </div>
    </div>
</div>
    <br>
    <br>
{% endblock %}